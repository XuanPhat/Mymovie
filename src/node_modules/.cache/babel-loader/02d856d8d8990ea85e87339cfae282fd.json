{"ast":null,"code":"var once = require('once');\n\nvar noop = function () {};\n\nvar isRequest = function (stream) {\n  return stream.setHeader && typeof stream.abort === 'function';\n};\n\nvar isChildProcess = function (stream) {\n  return stream.stdio && Array.isArray(stream.stdio) && stream.stdio.length === 3;\n};\n\nvar eos = function (stream, opts, callback) {\n  if (typeof opts === 'function') return eos(stream, null, opts);\n  if (!opts) opts = {};\n  callback = once(callback || noop);\n  var ws = stream._writableState;\n  var rs = stream._readableState;\n  var readable = opts.readable || opts.readable !== false && stream.readable;\n  var writable = opts.writable || opts.writable !== false && stream.writable;\n\n  var onlegacyfinish = function () {\n    if (!stream.writable) onfinish();\n  };\n\n  var onfinish = function () {\n    writable = false;\n    if (!readable) callback.call(stream);\n  };\n\n  var onend = function () {\n    readable = false;\n    if (!writable) callback.call(stream);\n  };\n\n  var onexit = function (exitCode) {\n    callback.call(stream, exitCode ? new Error('exited with error code: ' + exitCode) : null);\n  };\n\n  var onerror = function (err) {\n    callback.call(stream, err);\n  };\n\n  var onclose = function () {\n    if (readable && !(rs && rs.ended)) return callback.call(stream, new Error('premature close'));\n    if (writable && !(ws && ws.ended)) return callback.call(stream, new Error('premature close'));\n  };\n\n  var onrequest = function () {\n    stream.req.on('finish', onfinish);\n  };\n\n  if (isRequest(stream)) {\n    stream.on('complete', onfinish);\n    stream.on('abort', onclose);\n    if (stream.req) onrequest();else stream.on('request', onrequest);\n  } else if (writable && !ws) {\n    // legacy streams\n    stream.on('end', onlegacyfinish);\n    stream.on('close', onlegacyfinish);\n  }\n\n  if (isChildProcess(stream)) stream.on('exit', onexit);\n  stream.on('end', onend);\n  stream.on('finish', onfinish);\n  if (opts.error !== false) stream.on('error', onerror);\n  stream.on('close', onclose);\n  return function () {\n    stream.removeListener('complete', onfinish);\n    stream.removeListener('abort', onclose);\n    stream.removeListener('request', onrequest);\n    if (stream.req) stream.req.removeListener('finish', onfinish);\n    stream.removeListener('end', onlegacyfinish);\n    stream.removeListener('close', onlegacyfinish);\n    stream.removeListener('finish', onfinish);\n    stream.removeListener('exit', onexit);\n    stream.removeListener('end', onend);\n    stream.removeListener('error', onerror);\n    stream.removeListener('close', onclose);\n  };\n};\n\nmodule.exports = eos;","map":{"version":3,"sources":["D:/node_modules/npm/node_modules/end-of-stream/index.js"],"names":["once","require","noop","isRequest","stream","setHeader","abort","isChildProcess","stdio","Array","isArray","length","eos","opts","callback","ws","_writableState","rs","_readableState","readable","writable","onlegacyfinish","onfinish","call","onend","onexit","exitCode","Error","onerror","err","onclose","ended","onrequest","req","on","error","removeListener","module","exports"],"mappings":"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","sourcesContent":["var once = require('once');\r\n\r\nvar noop = function() {};\r\n\r\nvar isRequest = function(stream) {\r\n\treturn stream.setHeader && typeof stream.abort === 'function';\r\n};\r\n\r\nvar isChildProcess = function(stream) {\r\n\treturn stream.stdio && Array.isArray(stream.stdio) && stream.stdio.length === 3\r\n};\r\n\r\nvar eos = function(stream, opts, callback) {\r\n\tif (typeof opts === 'function') return eos(stream, null, opts);\r\n\tif (!opts) opts = {};\r\n\r\n\tcallback = once(callback || noop);\r\n\r\n\tvar ws = stream._writableState;\r\n\tvar rs = stream._readableState;\r\n\tvar readable = opts.readable || (opts.readable !== false && stream.readable);\r\n\tvar writable = opts.writable || (opts.writable !== false && stream.writable);\r\n\r\n\tvar onlegacyfinish = function() {\r\n\t\tif (!stream.writable) onfinish();\r\n\t};\r\n\r\n\tvar onfinish = function() {\r\n\t\twritable = false;\r\n\t\tif (!readable) callback.call(stream);\r\n\t};\r\n\r\n\tvar onend = function() {\r\n\t\treadable = false;\r\n\t\tif (!writable) callback.call(stream);\r\n\t};\r\n\r\n\tvar onexit = function(exitCode) {\r\n\t\tcallback.call(stream, exitCode ? new Error('exited with error code: ' + exitCode) : null);\r\n\t};\r\n\r\n\tvar onerror = function(err) {\r\n\t\tcallback.call(stream, err);\r\n\t};\r\n\r\n\tvar onclose = function() {\r\n\t\tif (readable && !(rs && rs.ended)) return callback.call(stream, new Error('premature close'));\r\n\t\tif (writable && !(ws && ws.ended)) return callback.call(stream, new Error('premature close'));\r\n\t};\r\n\r\n\tvar onrequest = function() {\r\n\t\tstream.req.on('finish', onfinish);\r\n\t};\r\n\r\n\tif (isRequest(stream)) {\r\n\t\tstream.on('complete', onfinish);\r\n\t\tstream.on('abort', onclose);\r\n\t\tif (stream.req) onrequest();\r\n\t\telse stream.on('request', onrequest);\r\n\t} else if (writable && !ws) { // legacy streams\r\n\t\tstream.on('end', onlegacyfinish);\r\n\t\tstream.on('close', onlegacyfinish);\r\n\t}\r\n\r\n\tif (isChildProcess(stream)) stream.on('exit', onexit);\r\n\r\n\tstream.on('end', onend);\r\n\tstream.on('finish', onfinish);\r\n\tif (opts.error !== false) stream.on('error', onerror);\r\n\tstream.on('close', onclose);\r\n\r\n\treturn function() {\r\n\t\tstream.removeListener('complete', onfinish);\r\n\t\tstream.removeListener('abort', onclose);\r\n\t\tstream.removeListener('request', onrequest);\r\n\t\tif (stream.req) stream.req.removeListener('finish', onfinish);\r\n\t\tstream.removeListener('end', onlegacyfinish);\r\n\t\tstream.removeListener('close', onlegacyfinish);\r\n\t\tstream.removeListener('finish', onfinish);\r\n\t\tstream.removeListener('exit', onexit);\r\n\t\tstream.removeListener('end', onend);\r\n\t\tstream.removeListener('error', onerror);\r\n\t\tstream.removeListener('close', onclose);\r\n\t};\r\n};\r\n\r\nmodule.exports = eos;\r\n"]},"metadata":{},"sourceType":"script"}